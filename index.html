<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Prompt Crafter</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f4f6ff;
      --card:#ffffff;
      --text:#121826;
      --muted:#6b7280;
      --brand:#4f46e5;
      --brand-2:#22c55e;
      --brand-3:#0284c7;
      --brand-4:#7c3aed;
      --brand-5:#f97316;
      --ring:rgba(79,70,229,.25);
      --border:#e5e7eb;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
    }
    .container{max-width:840px;margin:32px auto;padding:0 20px}
    .header{display:flex;align-items:center;gap:12px;margin-bottom:18px;}
    .logo{
      width:36px;height:36px;border-radius:10px;
      background: conic-gradient(from 180deg at 50% 50%, #06b6d4, #f59e0b, #ef4444, #06b6d4);
    }
    h1{font-size:28px;margin:0}
    .subtitle{color:var(--muted);font-size:14px;margin:6px 0 0}
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:14px;
      box-shadow:0 1px 1px rgba(0,0,0,.02), 0 6px 24px rgba(0,0,0,.04);
      padding:18px 18px;
    }
    .section-title{font-weight:600;margin:2px 0 10px}
    textarea, .output{
      width:100%;
      border:1px solid var(--border);
      border-radius:12px;
      background:#fff;
      color:var(--text);
      padding:14px;
      font-size:14px;
      outline:none;
      resize:vertical;
      min-height:110px;
    }
    textarea:focus, .output:focus{
      border-color:var(--brand);
      box-shadow:0 0 0 4px var(--ring);
    }
    .btn{
      user-select:none;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      padding:12px 16px;
      border-radius:12px;
      border:0;
      cursor:pointer;
      font-weight:600;
      color:#fff;
      transition:.18s transform ease, .18s opacity ease;
    }
    .btn:active{transform:translateY(1px)}
    .btn.convert{
      background:var(--brand);
      width:100%;
      margin:14px 0;
    }
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .btn.small{padding:10px 14px;font-size:14px;border-radius:10px}
    .btn.copy{background:#111827}
    .btn.claude{background:#111827}
    .btn.chatgpt{background:var(--brand-3)}
    .btn.gemini{background:var(--brand-4)}
    .btn.perplexity{background:var(--brand-5)}
    .muted{color:var(--muted);font-size:12px;margin-top:10px}
    .howto li{margin:6px 0}
    .topbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin:10px 0 18px;
    }
    .api-box{display:flex;gap:8px;align-items:center;}
    .api-input{
      width:320px;
      max-width:60vw;
      border:1px solid var(--border);
      border-radius:10px;
      padding:10px 12px;
      font-size:13px;
      outline:none;
      background:#fff;
    }
    .api-input:focus{
      border-color:var(--brand);
      box-shadow:0 0 0 4px var(--ring);
    }
    .btn.save{background:#10b981}
    .footer{color:var(--muted);font-size:12px;margin:18px 0}
  </style>
</head>

<body>
  <div class="container">

    <div class="topbar">
      <div class="header">
        <div class="logo"></div>
        <div>
          <h1>Prompt Crafter</h1>
          <div class="subtitle">Transform simple ideas into AI-ready instructions · Created by Vijay Kumar</div>
        </div>
      </div>

      <div class="api-box">
        <input id="apiKey" class="api-input" type="password" placeholder="Optional: OpenAI API Key (stored locally)" />
        <button class="btn small save" id="saveKeyBtn">Save</button>
      </div>
    </div>

    <!-- INPUT CARD -->
    <div class="card">
      <div class="section-title">Your Requirement</div>
      <textarea id="requirement" placeholder="Type your requirement in plain language, e.g.:
'Summarise this article in 3 bullet points for a non-technical manager.'"></textarea>
      <button id="convertBtn" class="btn convert">Convert to AI Instruction</button>
    </div>

    <div style="height:12px"></div>

    <!-- OUTPUT CARD -->
    <div class="card">
      <div class="section-title">AI-Ready Instruction</div>
      <textarea id="output" class="output" readonly placeholder="The instruction you can paste into ChatGPT, Claude, Gemini, or Perplexity will appear here..."></textarea>

      <div style="height:12px"></div>
      <div class="row">
        <button class="btn small copy" id="copyBtn">Copy Instruction</button>
        <button class="btn small claude" id="claudeBtn">Claude ↗</button>
        <button class="btn small chatgpt" id="chatgptBtn">ChatGPT ↗</button>
        <button class="btn small gemini" id="geminiBtn">Gemini ↗</button>
        <button class="btn small perplexity" id="perplexityBtn">Perplexity ↗</button>
      </div>

      <div class="muted">Click a button to copy the instruction and open the AI tool. The AI will be guided to directly answer, not rewrite your request.</div>
    </div>

    <div style="height:12px"></div>

    <!-- HOW TO USE CARD -->
    <div class="card">
      <div class="section-title">How to Use</div>
      <ol class="howto">
        <li>Type your requirement in plain language.</li>
        <li>Click <b>Convert to AI Instruction</b>.</li>
        <li>Check the generated instruction (it tells the AI to give the final answer, not another prompt).</li>
        <li>Click <b>Copy Instruction</b> or open any AI tool and paste.</li>
      </ol>

      <div class="footer">
        Tip: If you save an API key above, generation uses your fine-tuned model. Without a key, a local template will still generate a strong AI instruction.
      </div>
    </div>
  </div>

  <script>
    const OPENAI_API_URL = "https://api.openai.com/v1/chat/completions";
    const OPENAI_MODEL = "ft:gpt-3.5-turbo-1106:personal::CkAjxivm";

    // Load saved API key
    const apiKeyInput = document.getElementById('apiKey');
    const savedKey = localStorage.getItem('OPENAI_API_KEY');
    if (savedKey) apiKeyInput.value = savedKey;

    document.getElementById('saveKeyBtn').addEventListener('click', () => {
      localStorage.setItem('OPENAI_API_KEY', apiKeyInput.value.trim());
      alert('API key saved locally in your browser.');
    });

    const requirementEl = document.getElementById('requirement');
    const outputEl = document.getElementById('output');
    const convertBtn = document.getElementById('convertBtn');

    // Local fallback formatter (no API key)
    function localFormatter(raw) {
      const clean = (raw || '').trim() || '[No requirement provided]';

      return `You are an expert AI assistant.

The user request is:

"""${clean}"""

Your job is to directly fulfill this request.

Requirements:
- Understand the requirement deeply.
- Break the problem into logical parts if helpful.
- Maintain accuracy and professionalism.
- Do NOT rewrite or improve this request.
- Do NOT generate another prompt or set of instructions.
- Respond with the final answer ONLY, as if you are talking directly to the user.`;
    }

    async function generatePrompt() {
      const raw = requirementEl.value.trim();
      if (!raw) {
        alert('Please enter your requirement.');
        return '';
      }

      const apiKey = localStorage.getItem('OPENAI_API_KEY')?.trim();

      // No API key → fallback formatter (no external call)
      if (!apiKey) {
        const formatted = localFormatter(raw);
        outputEl.value = formatted;
        return formatted;
      }

      try {
        convertBtn.disabled = true;
        convertBtn.textContent = 'Converting...';

        const system = `You are Multi AI Task Crafter.

Your job is to take a plain-language requirement and turn it into a single, clear instruction that makes another AI model directly perform the task.

Guidelines:
- Assume the next AI model will only see your output.
- Instruct it to respond with the final answer only.
- Explicitly tell it NOT to rewrite the requirement or generate another prompt.
- Focus on clarity, context, and constraints.
- Do NOT wrap your output in code fences.
- Do NOT explain what you are doing; only output the final instruction.`;

        const response = await fetch(OPENAI_API_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer " + apiKey
          },
          body: JSON.stringify({
            model: OPENAI_MODEL,
            messages: [
              { role: "system", content: system },
              {
                role: "user",
                content:
`User requirement:

"""${raw}"""

Create a single, self-contained instruction for another AI model that will cause it to directly fulfill this requirement.

Important:
- Tell the AI to produce the final answer, not another prompt.
- Make the instruction clear enough that the AI can act immediately.`
              }
            ],
            temperature: 0.2
          })
        });

        if (!response.ok) throw new Error(await response.text());
        const data = await response.json();

        let text = data.choices?.[0]?.message?.content?.trim()
                 || localFormatter(raw);

        // Defensive: strip accidental code fences if the model adds them
        text = text.replace(/^```[^\n]*\n?/, "");
        text = text.replace(/```$/, "");

        outputEl.value = text.trim();
        return text.trim();

      } catch (err) {
        console.error(err);
        const fallback = localFormatter(raw);
        outputEl.value = fallback;
        return fallback;
      } finally {
        convertBtn.disabled = false;
        convertBtn.textContent = "Convert to AI Instruction";
      }
    }

    document.getElementById("convertBtn").addEventListener("click", generatePrompt);

    async function copyPrompt() {
      if (!outputEl.value) {
        await generatePrompt();
      }
      if (!outputEl.value) return;
      await navigator.clipboard.writeText(outputEl.value);
    }
    document.getElementById("copyBtn").addEventListener("click", copyPrompt);

    const openAfterCopy = (url) => async () => {
      await copyPrompt();
      window.open(url, "_blank");
    };

    document.getElementById("claudeBtn").addEventListener("click", openAfterCopy("https://claude.ai/new"));
    document.getElementById("chatgptBtn").addEventListener("click", openAfterCopy("https://chat.openai.com/"));
    document.getElementById("geminiBtn").addEventListener("click", openAfterCopy("https://gemini.google.com/app"));
    document.getElementById("perplexityBtn").addEventListener("click", openAfterCopy("https://www.perplexity.ai/"));
  </script>
</body>
</html>
